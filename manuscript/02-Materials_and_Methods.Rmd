# Materials and Methods

## Data

We used historical deforestation maps for Madagascar at 30m resolution for three time-periods: 1990-2000, 2000-2010, and 2010-2017 [@Vieilledent2018]. We tried to model the observed spatial deforestation process on the period 2000-2010 at the national level. Period 1990-2000 was used to compute the distance to past deforestation for each forest pixel in 2000. Period 2010-2017 was used to compare model forecasts with observations.

To explain the observed spatial deforestation on the period 2000-2010, we considered various spatial explicative variables describing: topography (altitude and slope), accessibility (distances to nearest road, town and river), forest landscape (distance to forest edge), deforestation history (distance to past deforestation) and land-tenure variables (protected area system). Characteristics of each variables are summarized in Tab. \@ref(tab:species).

Altitude (in m) and slope (in degree) at 90m resolution were obtained from the SRTM Digital Elevation Database v4.1 (<http://srtm.csi.cgiar.org/>). Distances (in m) to nearest road, town and river at 150m resolution were derived from the OpenStreetMap (OSM) project for Madagascar (<http://www.geofabrik.de/>). To obtain the road network in Madagascar, we considered the categories "motorway", "trunk", "primary", "secondary" and "tertiary" for the "highway" key in OSM. To obtain the network of populated places in Madagascar (that we simply call "towns" in the present study), we considered the categories "city", "town" and "village" for the "place" key in OSM. To obtain the river network in Madagascar, we considered the categories "river" and "canal" for the "waterway" key in OSM. For a more detailed description of each category, see the OSM wiki page (<https://wiki.openstreetmap.org/wiki/Tags>). Distance to forest edge was computed at 30m resolution from the forest cover map in 2000. Distance to past deforestation was computed at 30m resolution from the 1990-2000 forest cover change map. For the protected area system, we used the 20/12/2010 version of the SAPM "Système des Aires Protégées à Madagascar" (<http://rebioma.net/>) and considered both Protected Areas (created before 2003) and New Protected Areas in the SAPM terminology. Polygons representing protected areas were rasterized at 30m resolution. In total, we obtained 8 spatial variables that could explained the location of the deforestation.

## Models

We compared two deforestation models. The first model is a simple logistic regression model. We consider the random variable $y_i$ which takes value 1 if the forest pixel $i$ is deforested on the period 2000-2010 and 0 if it is not. We assumed that $y_i$ follows a Bernoulli distribution of parameter $\theta_i$. In our moded, $\theta_i$ represents the spatial probability of deforestation for pixel $i$. We assumed that $\theta_i$ is linked, through a logit function, to a linear combination of the explicative variables $X_i\beta$, where $X_i$ is the vector of explicative variables for pixel $i$ and $\beta$ are the model's parameters to be estimated. The first model is summarized in Equation \@ref(eq:glm).

\begin{equation}
\begin{split}
  y_i \sim \mathcal{B}ernoulli(\theta_i)\\
  \text{logit}(\theta_i) = X_i \beta
\end{split}
(\#eq:glm)
\end{equation}

The second model (Eq. \@ref(eq:icar)) includes a spatial random effect $\rho_j$ for each spatial cell of a 10 $\times$ 10 km grid over Madagascar. 

\begin{equation}
\begin{split}
  y_i \sim \mathcal{B}ernoulli(\theta_i)\\
  \text{logit}(\theta_i) = X_i \beta + \rho_j\\
  \rho_j \sim \mathcal{N}ormal(\mu_j,V_{\rho} / n_j)
\end{split}
(\#eq:icar)
\end{equation}

We used a sample of 20,000 forest pixels in 2000 to fit the two models. The sample was stratified between 10,000 deforested pixels in 2000-2010 and 10,000 non-deforested pixels. A balanced data-set is preferable in our case as we are not interested in estimating the intensity of deforestation but only the relative effect of each variable on the spatial probability of deforestation [@Dezecache2017].

Parameter inference was done in a hierarchical Bayesian framework. Non-informative priors were used for all parameters: $\beta \sim Normal(\text{mean}=0,\text{var}=10^6)$ and $V_{\rho} \sim 1/Gamma(\text{shape}=0.05,\text{rate}=0.0005)$. We used 2000 iterations for the burnin phase. We run a Markov Chain Monte Carlo (MCMC) of 5000 iterations, thining the chain at each 5 iterations. We obtained 1000 estimates for each parameter. MCMC convergence was visually checked looking a the trace and parameter posterior distributions. Function `model_binomial_iCAR()` from the `forestatrisk` Python package was used for parameter inference. This function calls an adaptive Metropolis-within-Gibbs algorithm [@Rosenthal2011] written in C for maximum computation speed.

## Model comparison through cross-validation

## Forecasting deforestation

## Forecasts skill scores

