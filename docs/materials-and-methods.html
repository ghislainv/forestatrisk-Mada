<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>2 Materials and Methods | Accounting for spatial regional variability in modelling and forecasting deforestation – the fate of Madagascar’s forests</title>
  <meta name="description" content="2 Materials and Methods | Accounting for spatial regional variability in modelling and forecasting deforestation – the fate of Madagascar’s forests">
  <meta name="generator" content="bookdown  and GitBook 2.6.7">

  <meta property="og:title" content="2 Materials and Methods | Accounting for spatial regional variability in modelling and forecasting deforestation – the fate of Madagascar’s forests" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="2 Materials and Methods | Accounting for spatial regional variability in modelling and forecasting deforestation – the fate of Madagascar’s forests" />
  
  
  

<meta name="author" content="Ghislain Vieilledent and Frédéric Achard">



  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="introduction.html">
<link rel="next" href="results.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<script src="libs/kePrint-0.0.1/kePrint.js"></script>



</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preambule</a></li>
<li class="chapter" data-level="" data-path="abstract.html"><a href="abstract.html"><i class="fa fa-check"></i>Abstract</a></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="materials-and-methods.html"><a href="materials-and-methods.html"><i class="fa fa-check"></i><b>2</b> Materials and Methods</a><ul>
<li class="chapter" data-level="2.1" data-path="materials-and-methods.html"><a href="materials-and-methods.html#data"><i class="fa fa-check"></i><b>2.1</b> Data</a></li>
<li class="chapter" data-level="2.2" data-path="materials-and-methods.html"><a href="materials-and-methods.html#models"><i class="fa fa-check"></i><b>2.2</b> Models</a></li>
<li class="chapter" data-level="2.3" data-path="materials-and-methods.html"><a href="materials-and-methods.html#model-comparison-through-cross-validation"><i class="fa fa-check"></i><b>2.3</b> Model comparison through cross-validation</a></li>
<li class="chapter" data-level="2.4" data-path="materials-and-methods.html"><a href="materials-and-methods.html#forecasting-deforestation"><i class="fa fa-check"></i><b>2.4</b> Forecasting deforestation</a></li>
<li class="chapter" data-level="2.5" data-path="materials-and-methods.html"><a href="materials-and-methods.html#forecasts-skill-scores"><i class="fa fa-check"></i><b>2.5</b> Forecasts skill scores</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="results.html"><a href="results.html"><i class="fa fa-check"></i><b>3</b> Results</a></li>
<li class="chapter" data-level="4" data-path="discussion.html"><a href="discussion.html"><i class="fa fa-check"></i><b>4</b> Discussion</a></li>
<li class="chapter" data-level="5" data-path="ackowledgements.html"><a href="ackowledgements.html"><i class="fa fa-check"></i><b>5</b> Ackowledgements</a></li>
<li class="chapter" data-level="6" data-path="tables.html"><a href="tables.html"><i class="fa fa-check"></i><b>6</b> Tables</a></li>
<li class="chapter" data-level="7" data-path="figures.html"><a href="figures.html"><i class="fa fa-check"></i><b>7</b> Figures</a></li>
<li class="chapter" data-level="8" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i><b>8</b> References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Accounting for spatial regional variability in modelling and forecasting deforestation – the fate of Madagascar’s forests</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="materials-and-methods" class="section level1">
<h1><span class="header-section-number">2</span> Materials and Methods</h1>
<div id="data" class="section level2">
<h2><span class="header-section-number">2.1</span> Data</h2>
<p>We used historical deforestation maps for Madagascar at 30m resolution for three time-periods: 1990-2000, 2000-2010, and 2010-2017 <span class="citation">(Vieilledent <em>et al.</em> <a href="#ref-Vieilledent2018">2018</a>)</span>. We tried to model the observed spatial deforestation process on the period 2000-2010 at the national level. Period 1990-2000 was used to compute the distance to past deforestation for each forest pixel in 2000. Period 2010-2017 was used to compare model forecasts with observations.</p>
<p>To explain the observed spatial deforestation on the period 2000-2010, we considered various spatial explicative variables describing: topography (altitude and slope), accessibility (distances to nearest road, town and river), forest landscape (distance to forest edge), deforestation history (distance to past deforestation) and land-tenure variables (protected area system). Characteristics of each variables are summarized in Tab. <a href="tables.html#tab:species">6.1</a>.</p>
<p>Altitude (in m) and slope (in degree) at 90m resolution were obtained from the SRTM Digital Elevation Database v4.1 (<a href="http://srtm.csi.cgiar.org/" class="uri">http://srtm.csi.cgiar.org/</a>). Distances (in m) to nearest road, town and river at 150m resolution were derived from the OpenStreetMap (OSM) project for Madagascar (<a href="http://www.geofabrik.de/" class="uri">http://www.geofabrik.de/</a>). To obtain the road network in Madagascar, we considered the categories “motorway”, “trunk”, “primary”, “secondary” and “tertiary” for the “highway” key in OSM. To obtain the network of populated places in Madagascar (that we simply call “towns” in the present study), we considered the categories “city”, “town” and “village” for the “place” key in OSM. To obtain the river network in Madagascar, we considered the categories “river” and “canal” for the “waterway” key in OSM. For a more detailed description of each category, see the OSM wiki page (<a href="https://wiki.openstreetmap.org/wiki/Tags" class="uri">https://wiki.openstreetmap.org/wiki/Tags</a>). Distance to forest edge was computed at 30m resolution from the forest cover map in 2000. Distance to past deforestation was computed at 30m resolution from the 1990-2000 forest cover change map. For the protected area system, we used the 20/12/2010 version of the SAPM “Système des Aires Protégées à Madagascar” (<a href="http://rebioma.net/" class="uri">http://rebioma.net/</a>) and considered both Protected Areas (created before 2003) and New Protected Areas in the SAPM terminology. Polygons representing protected areas were rasterized at 30m resolution. In total, we obtained 8 spatial variables that could explained the location of the deforestation.</p>
</div>
<div id="models" class="section level2">
<h2><span class="header-section-number">2.2</span> Models</h2>
<p>We compared two deforestation models. The first model is a simple logistic regression model. We consider the random variable <span class="math inline">\(y_i\)</span> which takes value 1 if the forest pixel <span class="math inline">\(i\)</span> is deforested on the period 2000-2010 and 0 if it is not. We assumed that <span class="math inline">\(y_i\)</span> follows a Bernoulli distribution of parameter <span class="math inline">\(\theta_i\)</span>. In our moded, <span class="math inline">\(\theta_i\)</span> represents the spatial probability of deforestation for pixel <span class="math inline">\(i\)</span>. We assumed that <span class="math inline">\(\theta_i\)</span> is linked, through a logit function, to a linear combination of the explicative variables <span class="math inline">\(X_i\beta\)</span>, where <span class="math inline">\(X_i\)</span> is the vector of explicative variables for pixel <span class="math inline">\(i\)</span> and <span class="math inline">\(\beta\)</span> are the model’s parameters to be estimated. The first model is summarized in Equation <a href="materials-and-methods.html#eq:glm">(2.1)</a>.</p>
<span class="math display" id="eq:glm">\[\begin{equation}
\begin{split}
  y_i \sim \mathcal{B}ernoulli(\theta_i)\\
  \text{logit}(\theta_i) = X_i \beta
\end{split}
\tag{2.1}
\end{equation}\]</span>
<p>The second model (Eq. <a href="materials-and-methods.html#eq:icar">(2.2)</a>) includes a spatial random effect <span class="math inline">\(\rho_j\)</span> for each spatial cell of a 10 <span class="math inline">\(\times\)</span> 10 km grid over Madagascar.</p>
<span class="math display" id="eq:icar">\[\begin{equation}
\begin{split}
  y_i \sim \mathcal{B}ernoulli(\theta_i)\\
  \text{logit}(\theta_i) = X_i \beta + \rho_j\\
  \rho_j \sim \mathcal{N}ormal(\mu_j,V_{\rho} / n_j)
\end{split}
\tag{2.2}
\end{equation}\]</span>
<p>We used a sample of 20,000 forest pixels in 2000 to fit the two models. The sample was stratified between 10,000 deforested pixels in 2000-2010 and 10,000 non-deforested pixels. A balanced data-set is preferable in our case as we are not interested in estimating the intensity of deforestation but only the relative effect of each variable on the spatial probability of deforestation <span class="citation">(Dezécache <em>et al.</em> <a href="#ref-Dezecache2017">2017</a>)</span>.</p>
<p>Parameter inference was done in a hierarchical Bayesian framework. Non-informative priors were used for all parameters: <span class="math inline">\(\beta \sim Normal(\text{mean}=0,\text{var}=10^6)\)</span> and <span class="math inline">\(V_{\rho} \sim 1/Gamma(\text{shape}=0.05,\text{rate}=0.0005)\)</span>. We used 2000 iterations for the burnin phase. We run a Markov Chain Monte Carlo (MCMC) of 5000 iterations, thining the chain at each 5 iterations. We obtained 1000 estimates for each parameter. MCMC convergence was visually checked looking a the trace and parameter posterior distributions. Function <code>model_binomial_iCAR()</code> from the <code>forestatrisk</code> Python package was used for parameter inference. This function calls an adaptive Metropolis-within-Gibbs algorithm <span class="citation">(Rosenthal &amp; others <a href="#ref-Rosenthal2011">2011</a>)</span> written in C for maximum computation speed.</p>
</div>
<div id="model-comparison-through-cross-validation" class="section level2">
<h2><span class="header-section-number">2.3</span> Model comparison through cross-validation</h2>
</div>
<div id="forecasting-deforestation" class="section level2">
<h2><span class="header-section-number">2.4</span> Forecasting deforestation</h2>
</div>
<div id="forecasts-skill-scores" class="section level2">
<h2><span class="header-section-number">2.5</span> Forecasts skill scores</h2>

</div>
</div>
<h3> References</h3>
<div id="refs" class="references">
<div id="ref-Vieilledent2018">
<p>Vieilledent, G., Grinand, C., Rakotomalala, F.A., Ranaivosoa, R., Rakotoarijaona, J.-R., Allnutt, T.F. &amp; Achard, F. (2018) Combining global tree cover loss data with historical national forest cover maps to look at six decades of deforestation and forest fragmentation in madagascar. <em>Biological Conservation</em>, <strong>222</strong>, 189–197.</p>
</div>
<div id="ref-Dezecache2017">
<p>Dezécache, C., Salles, J.-M., Vieilledent, G. &amp; Hérault, B. (2017) Moving forward socio-economically focused models of deforestation. <em>Global Change Biology</em>, <strong>23</strong>, 3484–3500.</p>
</div>
<div id="ref-Rosenthal2011">
<p>Rosenthal, J.S. &amp; others. (2011) Optimal proposal distributions and adaptive mcmc. <em>Handbook of Markov Chain Monte Carlo</em>, <strong>4</strong>.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="introduction.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="results.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"],
"instapper": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": null,
"history": {
"link": null,
"text": null
},
"download": ["manuscript.pdf"],
"toc": {
"collapse": "section",
"scroll_highlight": true
},
"toolbar": {
"position": "fixed"
},
"search": true
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
